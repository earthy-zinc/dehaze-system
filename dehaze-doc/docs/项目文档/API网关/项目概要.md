# API网关项目概要

## 概念

API网关主要用在微服务架构的系统中。在微服务体系结构中，人们将应用程序划分为几个低耦合的服务，叫做微服务。
每个服务都分担了系统中的不同功能。微服务更易于开发、部署和维护，适合构建大型系统。但是微服务将系统的各个功能
分散到了不同的地方，这样就对客户端访问造成了阻碍，客户端不清楚他需要的服务究竟在哪一个微服务中。对于某些业务，需要综合多个服务来实现，客户端很难一次性访问到他们所需要的信息。

API网关可以充当这些微服务的中介，客户端无需访问数十个单独的服务，而是仅仅需要向API网关发送单个请求。API
网关本身聚合了系统中所有的微服务，将客户端的请求分发到对应的微服务中。

API网关不仅仅可以分发请求，它还可以实现请求协议转换、参数校验、鉴定权限、降级熔断、限流、风险控制
等等多数系统通用的功能。

## 系统架构设计

那么如何设计一套能够支撑亿级吞吐量的网关呢？我们有以下几个要求：

1. 去中心化。在存在多个网关服务器时，当某个网关服务器掉线之后网关系统本身还能够继续提供服务。这就要求网关本身要采用分布式的架构。
2. 动态增减资源。为了增强网关对请求的动态处理能力，网管需要支持横向扩展。我们可以通过增加服务器来应对突发请求，也可以减少服务器来节约硬件资源
3. 解耦合。在设计实现上，要把网关通信模块、管理服务、SDK、注册中心、运营平台等分开单独开发实现，这样才能进行独立的组合包装使用。

因此我们将整个API网关在设计上分为五块：

1. 通信协议的处理：借助Netty处理HTTP请求，并且进行协议转换为RPC服务，返回数据。
2. 不同微服务的注册：
3. 路由服务的实现：
4. 责任链下的辅助功能的调用：鉴权、授信、熔断、降级、限流等功能不属于网关核心功能，但是作为多数系统通用的功能，我们也将其放入网关中实现。
5. 管理后台：

而我们将整个API网关在系统的实现上分为了五块：

1. 网关核心系统：用于网络通信转换处理，承接http请求，调用RPC服务，对责任链进行划分
2. 网关管理系统：用于网关接口后台管理，如服务注册、下线、停用。
3. 网关注册工具：用于注解方式采集接口，发送消息注册接口
4. 网关注册中心：提供网关注册中心服务，登记网关接口信息
5. 网关测试系统：提供和消费RPC接口
