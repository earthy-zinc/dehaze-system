---
tags: []
parent: 'Frequency Compensated Diffusion Model for Real-scene Dehazing'
collections:
    - 图像去雾
version: 4494
libraryID: 1
itemKey: 8WYAUYQQ

---
# 真实场景去雾的频率补偿扩散模型

## 摘要

基于条件扩散模型的去雾框架，主要优化模型中的高斯噪声向量，高斯噪声是一个非平凡向量。深度学习网络正频谱偏向性会阻碍高斯向量高频率的学习，从而影响图像细节重建。为了解决这个问题，作者设计了频率补偿块。该模块与一组滤波器共同强化输入信号中的中高频。使用该模块的扩散模型在感知和失真指标上都取得了显著效果。为了进一步提高泛化性能，提出了数据合成管道HazeAug，增强雾霾程度和多样性。

## 介绍

扩散模型在人眼感知方面效果较好，但是在PSNR、SSIM等定量指标上表现不佳，主要是因为重建的图像细节没有很好的对齐。本文发现了神经网络学习过程中的频谱偏向性，会在训练中优先学习低频函数。但是这一特性不符合扩散模型学习的目标，这就类似于用均匀分布的频谱来估计高斯早上向量。高频由于存在偏差会更难也更慢被学习，从而影响恢复高频图像细节。为了填补这个空白，作者提出了频率补偿块，用于选择性的强调输入信号中的中高频。在改善扩散模型的感知质量和失真测度方面是有效的。接下来提出的数据合成管道，目前去雾模型仅仅在合成数据集上训练，但是却直接应用于真实有雾图像。如果在更丰富的真实数据集上训练，模型会具有更强的泛化能力。但是目前的基于大气散射模型的合成数据集在雾霾程度和多样性方面有局限，HazeAug就着重于解决这方面问题。它通过将一副图像的雾霾迁移到另一幅图像上，生成了具有更多雾霾的样本，并且放大了雾霾的多样性。因此训练集就增加了很多在大气散射模型之外的数据，模型便能够获取更加广泛且真实的数据分布。

*   使用基于条件扩散模型的去雾模型，仅用合成数据集进行训练，就能够直接迁移到真实雾霾场景中应用，表现出优越的泛化性能。
*   设计了频率补偿块来缓解扩散模型的类高斯目标优化，提高了扩散模型在真实雾天场景下的感知和失真指标。
*   提出了数据增强管道，使去雾扩散模型能够以优越性能处理真实世界图像

## 相关工作

## 方法

### 条件去噪扩散模型

扩散模型，比如说去噪扩散概率模型(Denosing Diffusion Probabilistic Models, DDPMs)，通过注入早上腐蚀数据，然后学习其逆过程用于生成样本。该模型的采样从高斯噪声开始，并且通过进一步适应逆过程的学习来获得额外的条件输入。

给定一副清晰图像，在前向过程中添加高斯噪声重复破坏该图像。我们通过采样一个向量并且应用如下变换就可以的到具有噪声的图像。整个训练的逆向过程与训练一个神经网络来预测是一样的。因此我们可以举一反三应用到去雾中。

### 频率补偿块

传统端到端方法会优化一个参数，这个参数是神经网络学习到的去雾图像和真实值之间的像素距离。而扩散模型通过一个函数趋近器来预测，从频域上来看更具有启发性。自然图像的功率谱随着空间频率的增加而逐渐下贱，而高斯噪声是服从均匀功率密度谱的。深度神经网络由于优先拟合低频而高频信息在训练中学习的较晚。这些性质与自然图像的光谱吻合，但是对于学习噪声向量却不是最优的

因此作者提出频率补偿块，强调中高频，类似于信号处理中的滤波器设计，这样的频率补偿块是由一组卷积滤波器组成，仅允许浅层的中高频通过，并且通过跳跃连接将其传输到深层。滤波器选择应该遵循两个原则。1. 滤波器应该是径向对称的，避免偏向图像边缘和角落的高频特征。2. 滤波器的带宽应该覆盖网络难以捕获的频率范围。

### HazeAug


