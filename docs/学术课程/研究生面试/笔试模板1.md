# 试题名称：医院新冠管理系统

## 一、整体程序设计思路

使用语言C++11，整个程序主体以C语言面向过程的风格，但是使用了C++中的STL库。

## 二、程序完成情况统计表



## 三、各模块运行结果截图

### 1.模块1

![image-20220324155440894](C:\Users\Admin\AppData\Roaming\Typora\typora-user-images\image-20220324155440894.png)

![image-20220324155513752](C:\Users\Admin\AppData\Roaming\Typora\typora-user-images\image-20220324155513752.png)

![image-20220324155559032](C:\Users\Admin\AppData\Roaming\Typora\typora-user-images\image-20220324155559032.png)

### 2.模块2

![image-20220324162526371](C:\Users\Admin\AppData\Roaming\Typora\typora-user-images\image-20220324162526371.png)

### 3.模块3

![image-20220324162851150](C:\Users\Admin\AppData\Roaming\Typora\typora-user-images\image-20220324162851150.png)

### 4.模块4

![image-20220324163253651](C:\Users\Admin\AppData\Roaming\Typora\typora-user-images\image-20220324163253651.png)

### 5.模块5

![image-20220324163723348](C:\Users\Admin\AppData\Roaming\Typora\typora-user-images\image-20220324163723348.png)

## 四、数据定义

```c++
#include <windows.h>
#include <cstdio>
#include <cstring>
#include <iostream>
#include <vector>
#include <algorithm>

using namespace std;

typedef struct patient{
    char name[50];
    char gender[50];
    int age;
    char address[50];
    char phone[50];
    char email[50];
    char symptoms[50];
    char doctor[50];
}patient;
typedef struct vaccine{
    char name[50];
    char gender[50];
    int age;
    char date[50];
    char phone[50];
    char vaccineType[50];
}vaccine;
```



## 五、文件读写模块

```c++
//******文件读写模块**********
vector<patient> readPatientData(const char *fileName){
    patient p;
    vector<patient> patients;
    FILE *fp=fopen(fileName,"r");
    //文件不存在，则创建文件
    if (fp == NULL) {
		fp = fopen(fileName, "w");
	}
    while(fscanf(fp,"%s %s %d %s %s %s %s %s",\
            p.name, p.gender, &p.age, p.address,\
            p.phone, p.email, p.symptoms, p.doctor)>0){
        patients.push_back(p);
    }
    fclose(fp);
    return patients;
}

void writePatientData(const char *fileName,vector<patient> patients){
	FILE *fp=fopen(fileName,"w");
    for(int i=0;i<patients.size();i++){
        fprintf(fp,"%s %s %d %s %s %s %s %s\n",\
                patients[i].name, \
                patients[i].gender, \
                patients[i].age, \
                patients[i].address,\
                patients[i].phone, \
                patients[i].email, \
                patients[i].symptoms, \
                patients[i].doctor);
    }
    fclose(fp);
}

vector<vaccine> readVaccineData(const char *fileName){
    vaccine v;
    vector<vaccine> vaccines;
    FILE *fp=fopen(fileName,"r");
    //文件不存在，则创建文件
    if (fp == NULL) {
		fp = fopen(fileName, "w");
	}
    while(fscanf(fp,"%s %s %d %s %s %s",\
            v.name, v.gender, &v.age, v.date,\
            v.phone, v.vaccineType)>0){
        vaccines.push_back(v);
    }
    fclose(fp);
    return vaccines;
}

void writeVaccineData(const char *fileName,vector<vaccine> vaccines){
	FILE *fp=fopen(fileName,"w");
    for(int i=0;i<vaccines.size();i++){
        fprintf(fp,"%s %s %d %s %s %s",\
            vaccines[i].name, \
            vaccines[i].gender, \
            vaccines[i].age, \
            vaccines[i].date,\
            vaccines[i].phone, \
            vaccines[i].vaccineType);
    }
    fclose(fp);
}
```



## 六、模块1

如果有登录界面的话说明需要建立 用户 数据组来管理登录用户。

```c++
void welcome(){
	printf("######################################\n");
	printf("#        欢迎使用新冠管理系统        #\n");
    printf("######################################\n");
    system("pause");
}

void header(){
    printf("--------------------------------------------\n");
    printf("                新冠管理系统\n");
    printf("--------------------------------------------\n");
}

void login(){
    system("cls");
    header();
    char id[50],password[50];
    while(true){
        printf("输入用户名及密码：\n");
        printf("用户名：");
        cin>>id;
        printf("密码：");
        cin>>password;

        if(strcmp(id,"admin")==0 &&  strcmp(password,"12345")==0){
            printf("登录成功，");
            break;
        }else{
            printf("用户名或密码错误，请重新输入：\n");
        }
    }
    system("pause");
}

void system(){
    printf("1.新增患者记录\n");
    printf("2.统计患者信息\n");
    printf("3.查询患者信息\n");
    printf("4.新增疫苗接种记录\n");
    printf("5.退出系统\n");
    printf("\n");
    
}

void mainPage(){

    while(true){
        system("cls");
        header();
        system();

        printf("请选择相应的功能（1-5）：↙\n");
        int flag;
    	cin>>flag;

        if(flag==1){
            addPatient();
        }else if(flag==2){
            statistics();
        }else if(flag==3){
            searchPatient();
        }else if(flag==4){
            addVaccinationRecord();
        }else if(flag==5){
            exit(0);
        }else{
            printf("输入无效，请重新选择：\n");
        }
    }
}
```



## 七、模块2

```c++
//***********模块2***********
/* 姓名只能包含2-6个字符，主治医生只能包含2-6个字。
* 性别只能输入为“男”或“女”，
* 年龄限定在1-120之间，
* 住址只能包含2-10个字，
* 手机只能由11个数字组成，
* 邮箱必须满足xxx@xxx.com的格式，
* 症状只能包含2-15个字，
*/

void getName(char *name){
    while(true){
        printf("姓名：");
        cin>>name;
        if(strlen(name)<2 || strlen(name)>6){
            printf("输入无效，姓名只能包含2-6个字符。请重新输入！\n");
        }else{
            break;
        }
    }
}
void getGender(char *gender){
    while(true){
        printf("性别[男/女]：");
        cin>>gender;
        if(strcmp(gender,"男")==0 || strcmp(gender,"女")==0){
            break;
        }else{
            printf("输入无效，性别只能输入为“男”或“女”。请重新输入！\n");
        }
    }
}
void getAge(int& age){
    while(true){
        printf("年龄：");
        cin>>age;
        if(age>120 || age<1){
            printf("输入无效，年龄限定在1-120之间。请重新输入！\n");
        }else{
            break;
        }
    }
}
void getAddress(char *address){
    while(true){
        printf("住址：");
        cin>>address;
        if(strlen(address)<4 || strlen(address)>20){
            printf("输入无效，住址只能包含2-10个字。请重新输入！\n");
        }else{
            break;
        }
    }
}
void getPhone(char *phone){
    while(true){
        bool flag=true;

        printf("手机：");
        cin>>phone;

        if(strlen(phone)!=11){
            flag=false;
        }
        
        for(int i=0;i<strlen(phone);i++){
            if(phone[i]=='0'){
                continue;
            }
            if(isdigit(phone[i])==0){
                flag=false;
            }
        }

        if(flag){ 
            break;
        }else{
            printf("输入无效，手机只能由11个数字组成。请重新输入！\n");
        }
    }
}
void getEmail(char *email){
    while(true){
        printf("邮箱：");
        cin>>email;
        int i,j;
        for(i=0;i<strlen(email);i++){
			if(email[i]=='@'){
                break;
            }
        }
        break;
    }
}
void getSymptoms(char *symptoms){
    while(true){
        printf("症状：");
        cin>>symptoms;
        if(strlen(symptoms)<4 || strlen(symptoms)>30){
            printf("输入无效，症状只能包含2-15个字。请重新输入！\n");
        }else{
            break;
        }
    }
}
void getDoctor(char *doctor){
    while(true){
        printf("主治医生：");
        cin>>doctor;
        if(strlen(doctor)<2 || strlen(doctor)>6){
            printf("输入无效，主治医生只能包含2-6个字符。请重新输入！\n");
        }else{
            break;
        }
    }
}
void getDate(char *date){
    while(true){
        printf("接种日期（dd/mm/yy）");
        int dd,mm,yy;
        int flag=scanf("%d/%d/%d",&dd,&mm,&yy);
        if(flag!=3){
            printf("输入无效，接种日期的格式为（dd/mm/yy）。请重新输入！\n");
        }else{
            //strcpy(date,)
            break;
        }
    }
}
void getVaccineType(char *vaccineType){
    printf("选择疫苗：\n");
    printf("	1.国药中生北京\n");
    printf("	2.国药中生武汉\n");
    printf("	3.北京科兴中维\n");
    printf("请选择（1-3）：");
    while(true){
        int flag;
        cin>>flag;
        if(flag==1){
            strcpy(vaccineType,"国药中生北京");
            break;
        }else if(flag==2){
            strcpy(vaccineType,"国药中生武汉");
            break;
        }else if(flag==3){
            strcpy(vaccineType,"北京科兴中维");
            break;
        }else{
            printf("输入无效，请重新输入！\n");
        }
    }
}

void addPatient(){
    vector<patient> patients=readPatientData(patientInfo);

    char c='Y';
    while(c=='Y'){
        system("cls");
        header();
        printf("！！！！新增一条患者记录！！！！！\n");
        patient p={0};
        getName(p.name);
        getGender(p.gender);
        getAge(p.age);
        getAddress(p.address);
        getPhone(p.phone);
        getEmail(p.email);
        getSymptoms(p.symptoms);
        getDoctor(p.doctor);

        patients.push_back(p);
        printf("……………患者信息录入成功……………\n");
        printf("是否继续录入[Y/N]：");
        cin>>c;

    }
    printf("感谢使用！\n");
    writePatientData(patientInfo,patients);
}

```





## 八、模块3

```c++
//***********模块3***********
bool cmp(patient p1,patient p2){
    return p1.age>p2.age ? true : false;
}
void statistics(){
    header();
    printf("！！！！患者信息统计！！！！！\n");
    printf("姓名\t性别\t年龄\t住址\t手机\t邮箱\t症状\t主治医生\n");
    printf("========================================================================\n");

    vector<patient> patients=readPatientData(patientInfo);
    auto start=patients.begin(),end=patients.end();
    sort(start,end,cmp);

    for(int i=0;i<patients.size();i++){
        printf("%s\t%s\t%d\t%s\t" "%s\t%s\t%s\t%s\n",\
                patients[i].name, \
                patients[i].gender, \
                patients[i].age, \
                patients[i].address,\
                patients[i].phone, \
                patients[i].email, \
                patients[i].symptoms, \
                patients[i].doctor);
    }
    system("pause");
}


```







## 九、模块4

```c++
//***********模块4***********
void searchPatient(){
    vector<patient> patients=readPatientData(patientInfo);
    auto start=patients.begin(),end=patients.end();    

    char c='Y';
    while(c=='Y'){
        system("cls");
        header();
        printf("！！！！患者信息查询！！！！！\n");
        
        char name[50];
        getName(name);

        vector<patient> goals;
        while (start!=end){
            if(strcmp((*start).name,name)==0){
                goals.push_back(*start);
            }
            start++;
        }

        if(goals.size()!=0){
            printf("姓名\t性别\t年龄\t住址\t手机\t邮箱\t症状\t主治医生\n");
            printf("========================================================================\n");
            for(int i=0;i<goals.size();i++){
                printf("%s\t%s\t%d\t%s\t" "%s\t%s\t%s\t%s\n",\
                        goals[i].name, \
                        goals[i].gender, \
                        goals[i].age, \
                        goals[i].address,\
                        goals[i].phone, \
                        goals[i].email, \
                        goals[i].symptoms, \
                        goals[i].doctor);
            }
        }else{
            printf("未查询到该患者信息！\n");
        }

        printf("是否继续查询[Y/N]：");
        cin>>c;
    }
    printf("感谢使用！\n");
}

```

## 十、模块5

```c++
//***********模块5***********
void addVaccinationRecord(){
    vector<vaccine> vaccines=readVaccineData(vaccineInfo);

    char c='Y';
    while(c=='Y'){
        system("cls");
        header();
        printf("！！！！疫苗接种系统！！！！！\n");
        vaccine v;
        getName(v.name);
        getGender(v.gender);
        getAge(v.age);
        getDate(v.date);
        getPhone(v.phone);
        getVaccineType(v.vaccineType);

        vaccines.push_back(v);
        printf("…………%s接种信息录入成功！…………\n",v.vaccineType);
        printf("是否继续录入[Y/N]：");
        cin>>c;
    }
    writeVaccineData(vaccineInfo,vaccines);
    printf("感谢使用！\n");
}

```



